import{g as De,t as jt,b as H}from"./index.browser.esm.f664673d.js";import{l as Ft,D as Xt,T as He,a as Vt,b as Bt,c as qt}from"./0.848c5abe.js";var Tt={exports:{}},x=Tt.exports={},q,M;function Ae(){throw new Error("setTimeout has not been defined")}function be(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?q=setTimeout:q=Ae}catch{q=Ae}try{typeof clearTimeout=="function"?M=clearTimeout:M=be}catch{M=be}})();function yt(r){if(q===setTimeout)return setTimeout(r,0);if((q===Ae||!q)&&setTimeout)return q=setTimeout,setTimeout(r,0);try{return q(r,0)}catch{try{return q.call(null,r,0)}catch{return q.call(this,r,0)}}}function Mt(r){if(M===clearTimeout)return clearTimeout(r);if((M===be||!M)&&clearTimeout)return M=clearTimeout,clearTimeout(r);try{return M(r)}catch{try{return M.call(null,r)}catch{return M.call(this,r)}}}var W=[],re=!1,ee,fe=-1;function Ht(){!re||!ee||(re=!1,ee.length?W=ee.concat(W):fe=-1,W.length&&Lt())}function Lt(){if(!re){var r=yt(Ht);re=!0;for(var n=W.length;n;){for(ee=W,W=[];++fe<n;)ee&&ee[fe].run();fe=-1,n=W.length}ee=null,re=!1,Mt(r)}}x.nextTick=function(r){var n=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)n[t-1]=arguments[t];W.push(new Nt(r,n)),W.length===1&&!re&&yt(Lt)};function Nt(r,n){this.fun=r,this.array=n}Nt.prototype.run=function(){this.fun.apply(null,this.array)};x.title="browser";x.browser=!0;x.env={};x.argv=[];x.version="";x.versions={};function K(){}x.on=K;x.addListener=K;x.once=K;x.off=K;x.removeListener=K;x.removeAllListeners=K;x.emit=K;x.prependListener=K;x.prependOnceListener=K;x.listeners=function(r){return[]};x.binding=function(r){throw new Error("process.binding is not supported")};x.cwd=function(){return"/"};x.chdir=function(r){throw new Error("process.chdir is not supported")};x.umask=function(){return 0};var zt=Tt.exports;const ze=De(zt);var wt={};const Yt=jt(Ft);(function(r){r.__esModule=!0;var n=Yt,t=5;function i(a){var l=H.Buffer.alloc(2);return l.writeUInt16BE(a,0),l}var c={data:H.Buffer.alloc(0),dataLength:0,sequence:0},e=function(a,l){return{makeBlocks:function(s){var o=H.Buffer.concat([i(s.length),s]),h=l-5,f=Math.ceil(o.length/h);o=H.Buffer.concat([o,H.Buffer.alloc(f*h-o.length+1).fill(0)]);for(var S=[],v=0;v<f;v++){var E=H.Buffer.alloc(5);E.writeUInt16BE(a,0),E.writeUInt8(t,2),E.writeUInt16BE(v,3);var _=o.slice(v*h,(v+1)*h);S.push(H.Buffer.concat([E,_]))}return S},reduceResponse:function(s,o){var h=s||c,f=h.data,S=h.dataLength,v=h.sequence;if(o.readUInt16BE(0)!==a)throw new n.TransportError("Invalid channel","InvalidChannel");if(o.readUInt8(2)!==t)throw new n.TransportError("Invalid tag","InvalidTag");if(o.readUInt16BE(3)!==v)throw new n.TransportError("Invalid sequence","InvalidSequence");s||(S=o.readUInt16BE(5)),v++;var E=o.slice(s?5:7);return f=H.Buffer.concat([f,E]),f.length>S&&(f=f.slice(0,S)),{data:f,dataLength:S,sequence:v}},getReducedResult:function(s){if(s&&s.dataLength===s.data.length)return s.data}}};r.default=e})(wt);const Wt=De(wt);var xe={exports:{}};const Kt="2.0.0",Ot=256,Qt=Number.MAX_SAFE_INTEGER||9007199254740991,Zt=16,Jt=Ot-6,kt=["major","premajor","minor","preminor","patch","prepatch","prerelease"];var ve={MAX_LENGTH:Ot,MAX_SAFE_COMPONENT_LENGTH:Zt,MAX_SAFE_BUILD_LENGTH:Jt,MAX_SAFE_INTEGER:Qt,RELEASE_TYPES:kt,SEMVER_SPEC_VERSION:Kt,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2};const er=(typeof ze=="object"&&ze.env,()=>{});var de=er;(function(r,n){const{MAX_SAFE_COMPONENT_LENGTH:t,MAX_SAFE_BUILD_LENGTH:i,MAX_LENGTH:c}=ve,e=de;n=r.exports={};const a=n.re=[],l=n.safeRe=[],s=n.src=[],o=n.t={};let h=0;const f="[a-zA-Z0-9-]",S=[["\\s",1],["\\d",c],[f,i]],v=_=>{for(const[b,U]of S)_=_.split(`${b}*`).join(`${b}{0,${U}}`).split(`${b}+`).join(`${b}{1,${U}}`);return _},E=(_,b,U)=>{const P=v(b),y=h++;e(_,y,b),o[_]=y,s[y]=b,a[y]=new RegExp(b,U?"g":void 0),l[y]=new RegExp(P,U?"g":void 0)};E("NUMERICIDENTIFIER","0|[1-9]\\d*"),E("NUMERICIDENTIFIERLOOSE","\\d+"),E("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${f}*`),E("MAINVERSION",`(${s[o.NUMERICIDENTIFIER]})\\.(${s[o.NUMERICIDENTIFIER]})\\.(${s[o.NUMERICIDENTIFIER]})`),E("MAINVERSIONLOOSE",`(${s[o.NUMERICIDENTIFIERLOOSE]})\\.(${s[o.NUMERICIDENTIFIERLOOSE]})\\.(${s[o.NUMERICIDENTIFIERLOOSE]})`),E("PRERELEASEIDENTIFIER",`(?:${s[o.NUMERICIDENTIFIER]}|${s[o.NONNUMERICIDENTIFIER]})`),E("PRERELEASEIDENTIFIERLOOSE",`(?:${s[o.NUMERICIDENTIFIERLOOSE]}|${s[o.NONNUMERICIDENTIFIER]})`),E("PRERELEASE",`(?:-(${s[o.PRERELEASEIDENTIFIER]}(?:\\.${s[o.PRERELEASEIDENTIFIER]})*))`),E("PRERELEASELOOSE",`(?:-?(${s[o.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${s[o.PRERELEASEIDENTIFIERLOOSE]})*))`),E("BUILDIDENTIFIER",`${f}+`),E("BUILD",`(?:\\+(${s[o.BUILDIDENTIFIER]}(?:\\.${s[o.BUILDIDENTIFIER]})*))`),E("FULLPLAIN",`v?${s[o.MAINVERSION]}${s[o.PRERELEASE]}?${s[o.BUILD]}?`),E("FULL",`^${s[o.FULLPLAIN]}$`),E("LOOSEPLAIN",`[v=\\s]*${s[o.MAINVERSIONLOOSE]}${s[o.PRERELEASELOOSE]}?${s[o.BUILD]}?`),E("LOOSE",`^${s[o.LOOSEPLAIN]}$`),E("GTLT","((?:<|>)?=?)"),E("XRANGEIDENTIFIERLOOSE",`${s[o.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),E("XRANGEIDENTIFIER",`${s[o.NUMERICIDENTIFIER]}|x|X|\\*`),E("XRANGEPLAIN",`[v=\\s]*(${s[o.XRANGEIDENTIFIER]})(?:\\.(${s[o.XRANGEIDENTIFIER]})(?:\\.(${s[o.XRANGEIDENTIFIER]})(?:${s[o.PRERELEASE]})?${s[o.BUILD]}?)?)?`),E("XRANGEPLAINLOOSE",`[v=\\s]*(${s[o.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[o.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[o.XRANGEIDENTIFIERLOOSE]})(?:${s[o.PRERELEASELOOSE]})?${s[o.BUILD]}?)?)?`),E("XRANGE",`^${s[o.GTLT]}\\s*${s[o.XRANGEPLAIN]}$`),E("XRANGELOOSE",`^${s[o.GTLT]}\\s*${s[o.XRANGEPLAINLOOSE]}$`),E("COERCE",`(^|[^\\d])(\\d{1,${t}})(?:\\.(\\d{1,${t}}))?(?:\\.(\\d{1,${t}}))?(?:$|[^\\d])`),E("COERCERTL",s[o.COERCE],!0),E("LONETILDE","(?:~>?)"),E("TILDETRIM",`(\\s*)${s[o.LONETILDE]}\\s+`,!0),n.tildeTrimReplace="$1~",E("TILDE",`^${s[o.LONETILDE]}${s[o.XRANGEPLAIN]}$`),E("TILDELOOSE",`^${s[o.LONETILDE]}${s[o.XRANGEPLAINLOOSE]}$`),E("LONECARET","(?:\\^)"),E("CARETTRIM",`(\\s*)${s[o.LONECARET]}\\s+`,!0),n.caretTrimReplace="$1^",E("CARET",`^${s[o.LONECARET]}${s[o.XRANGEPLAIN]}$`),E("CARETLOOSE",`^${s[o.LONECARET]}${s[o.XRANGEPLAINLOOSE]}$`),E("COMPARATORLOOSE",`^${s[o.GTLT]}\\s*(${s[o.LOOSEPLAIN]})$|^$`),E("COMPARATOR",`^${s[o.GTLT]}\\s*(${s[o.FULLPLAIN]})$|^$`),E("COMPARATORTRIM",`(\\s*)${s[o.GTLT]}\\s*(${s[o.LOOSEPLAIN]}|${s[o.XRANGEPLAIN]})`,!0),n.comparatorTrimReplace="$1$2$3",E("HYPHENRANGE",`^\\s*(${s[o.XRANGEPLAIN]})\\s+-\\s+(${s[o.XRANGEPLAIN]})\\s*$`),E("HYPHENRANGELOOSE",`^\\s*(${s[o.XRANGEPLAINLOOSE]})\\s+-\\s+(${s[o.XRANGEPLAINLOOSE]})\\s*$`),E("STAR","(<|>)?=?\\s*\\*"),E("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),E("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(xe,xe.exports);var ae=xe.exports;const tr=Object.freeze({loose:!0}),rr=Object.freeze({}),nr=r=>r?typeof r!="object"?tr:r:rr;var Ue=nr;const Ye=/^[0-9]+$/,At=(r,n)=>{const t=Ye.test(r),i=Ye.test(n);return t&&i&&(r=+r,n=+n),r===n?0:t&&!i?-1:i&&!t?1:r<n?-1:1},sr=(r,n)=>At(n,r);var bt={compareIdentifiers:At,rcompareIdentifiers:sr};const oe=de,{MAX_LENGTH:We,MAX_SAFE_INTEGER:le}=ve,{safeRe:Ke,t:Qe}=ae,ir=Ue,{compareIdentifiers:te}=bt;let ar=class B{constructor(n,t){if(t=ir(t),n instanceof B){if(n.loose===!!t.loose&&n.includePrerelease===!!t.includePrerelease)return n;n=n.version}else if(typeof n!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof n}".`);if(n.length>We)throw new TypeError(`version is longer than ${We} characters`);oe("SemVer",n,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const i=n.trim().match(t.loose?Ke[Qe.LOOSE]:Ke[Qe.FULL]);if(!i)throw new TypeError(`Invalid Version: ${n}`);if(this.raw=n,this.major=+i[1],this.minor=+i[2],this.patch=+i[3],this.major>le||this.major<0)throw new TypeError("Invalid major version");if(this.minor>le||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>le||this.patch<0)throw new TypeError("Invalid patch version");i[4]?this.prerelease=i[4].split(".").map(c=>{if(/^[0-9]+$/.test(c)){const e=+c;if(e>=0&&e<le)return e}return c}):this.prerelease=[],this.build=i[5]?i[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(n){if(oe("SemVer.compare",this.version,this.options,n),!(n instanceof B)){if(typeof n=="string"&&n===this.version)return 0;n=new B(n,this.options)}return n.version===this.version?0:this.compareMain(n)||this.comparePre(n)}compareMain(n){return n instanceof B||(n=new B(n,this.options)),te(this.major,n.major)||te(this.minor,n.minor)||te(this.patch,n.patch)}comparePre(n){if(n instanceof B||(n=new B(n,this.options)),this.prerelease.length&&!n.prerelease.length)return-1;if(!this.prerelease.length&&n.prerelease.length)return 1;if(!this.prerelease.length&&!n.prerelease.length)return 0;let t=0;do{const i=this.prerelease[t],c=n.prerelease[t];if(oe("prerelease compare",t,i,c),i===void 0&&c===void 0)return 0;if(c===void 0)return 1;if(i===void 0)return-1;if(i===c)continue;return te(i,c)}while(++t)}compareBuild(n){n instanceof B||(n=new B(n,this.options));let t=0;do{const i=this.build[t],c=n.build[t];if(oe("prerelease compare",t,i,c),i===void 0&&c===void 0)return 0;if(c===void 0)return 1;if(i===void 0)return-1;if(i===c)continue;return te(i,c)}while(++t)}inc(n,t,i){switch(n){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,i);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,i);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,i),this.inc("pre",t,i);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t,i),this.inc("pre",t,i);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const c=Number(i)?1:0;if(!t&&i===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[c];else{let e=this.prerelease.length;for(;--e>=0;)typeof this.prerelease[e]=="number"&&(this.prerelease[e]++,e=-2);if(e===-1){if(t===this.prerelease.join(".")&&i===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(c)}}if(t){let e=[t,c];i===!1&&(e=[t]),te(this.prerelease[0],t)===0?isNaN(this.prerelease[1])&&(this.prerelease=e):this.prerelease=e}break}default:throw new Error(`invalid increment argument: ${n}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};var G=ar;const Ze=G,or=(r,n,t=!1)=>{if(r instanceof Ze)return r;try{return new Ze(r,n)}catch(i){if(!t)return null;throw i}};var ne=or;const lr=ne,cr=(r,n)=>{const t=lr(r,n);return t?t.version:null};var ur=cr;const hr=ne,fr=(r,n)=>{const t=hr(r.trim().replace(/^[=v]+/,""),n);return t?t.version:null};var pr=fr;const Je=G,vr=(r,n,t,i,c)=>{typeof t=="string"&&(c=i,i=t,t=void 0);try{return new Je(r instanceof Je?r.version:r,t).inc(n,i,c).version}catch{return null}};var dr=vr;const ke=ne,Er=(r,n)=>{const t=ke(r,null,!0),i=ke(n,null,!0),c=t.compare(i);if(c===0)return null;const e=c>0,a=e?t:i,l=e?i:t,s=!!a.prerelease.length;if(!!l.prerelease.length&&!s)return!l.patch&&!l.minor?"major":a.patch?"patch":a.minor?"minor":"major";const h=s?"pre":"";return t.major!==i.major?h+"major":t.minor!==i.minor?h+"minor":t.patch!==i.patch?h+"patch":"prerelease"};var mr=Er;const $r=G,gr=(r,n)=>new $r(r,n).major;var Ir=gr;const Rr=G,Sr=(r,n)=>new Rr(r,n).minor;var Tr=Sr;const yr=G,Lr=(r,n)=>new yr(r,n).patch;var Nr=Lr;const wr=ne,Or=(r,n)=>{const t=wr(r,n);return t&&t.prerelease.length?t.prerelease:null};var Ar=Or;const et=G,br=(r,n,t)=>new et(r,t).compare(new et(n,t));var X=br;const xr=X,_r=(r,n,t)=>xr(n,r,t);var Pr=_r;const Cr=X,Dr=(r,n)=>Cr(r,n,!0);var Ur=Dr;const tt=G,Gr=(r,n,t)=>{const i=new tt(r,t),c=new tt(n,t);return i.compare(c)||i.compareBuild(c)};var Ge=Gr;const jr=Ge,Fr=(r,n)=>r.sort((t,i)=>jr(t,i,n));var Xr=Fr;const Vr=Ge,Br=(r,n)=>r.sort((t,i)=>Vr(i,t,n));var qr=Br;const Mr=X,Hr=(r,n,t)=>Mr(r,n,t)>0;var Ee=Hr;const zr=X,Yr=(r,n,t)=>zr(r,n,t)<0;var je=Yr;const Wr=X,Kr=(r,n,t)=>Wr(r,n,t)===0;var xt=Kr;const Qr=X,Zr=(r,n,t)=>Qr(r,n,t)!==0;var _t=Zr;const Jr=X,kr=(r,n,t)=>Jr(r,n,t)>=0;var Fe=kr;const en=X,tn=(r,n,t)=>en(r,n,t)<=0;var Xe=tn;const rn=xt,nn=_t,sn=Ee,an=Fe,on=je,ln=Xe,cn=(r,n,t,i)=>{switch(n){case"===":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r===t;case"!==":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r!==t;case"":case"=":case"==":return rn(r,t,i);case"!=":return nn(r,t,i);case">":return sn(r,t,i);case">=":return an(r,t,i);case"<":return on(r,t,i);case"<=":return ln(r,t,i);default:throw new TypeError(`Invalid operator: ${n}`)}};var Pt=cn;const un=G,hn=ne,{safeRe:ce,t:ue}=ae,fn=(r,n)=>{if(r instanceof un)return r;if(typeof r=="number"&&(r=String(r)),typeof r!="string")return null;n=n||{};let t=null;if(!n.rtl)t=r.match(ce[ue.COERCE]);else{let i;for(;(i=ce[ue.COERCERTL].exec(r))&&(!t||t.index+t[0].length!==r.length);)(!t||i.index+i[0].length!==t.index+t[0].length)&&(t=i),ce[ue.COERCERTL].lastIndex=i.index+i[1].length+i[2].length;ce[ue.COERCERTL].lastIndex=-1}return t===null?null:hn(`${t[2]}.${t[3]||"0"}.${t[4]||"0"}`,n)};var pn=fn,ge,rt;function vn(){return rt||(rt=1,ge=function(r){r.prototype[Symbol.iterator]=function*(){for(let n=this.head;n;n=n.next)yield n.value}}),ge}var Ie,nt;function dn(){if(nt)return Ie;nt=1,Ie=r,r.Node=c,r.create=r;function r(e){var a=this;if(a instanceof r||(a=new r),a.tail=null,a.head=null,a.length=0,e&&typeof e.forEach=="function")e.forEach(function(o){a.push(o)});else if(arguments.length>0)for(var l=0,s=arguments.length;l<s;l++)a.push(arguments[l]);return a}r.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var a=e.next,l=e.prev;return a&&(a.prev=l),l&&(l.next=a),e===this.head&&(this.head=a),e===this.tail&&(this.tail=l),e.list.length--,e.next=null,e.prev=null,e.list=null,a},r.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var a=this.head;e.list=this,e.next=a,a&&(a.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},r.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var a=this.tail;e.list=this,e.prev=a,a&&(a.next=e),this.tail=e,this.head||(this.head=e),this.length++}},r.prototype.push=function(){for(var e=0,a=arguments.length;e<a;e++)t(this,arguments[e]);return this.length},r.prototype.unshift=function(){for(var e=0,a=arguments.length;e<a;e++)i(this,arguments[e]);return this.length},r.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},r.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},r.prototype.forEach=function(e,a){a=a||this;for(var l=this.head,s=0;l!==null;s++)e.call(a,l.value,s,this),l=l.next},r.prototype.forEachReverse=function(e,a){a=a||this;for(var l=this.tail,s=this.length-1;l!==null;s--)e.call(a,l.value,s,this),l=l.prev},r.prototype.get=function(e){for(var a=0,l=this.head;l!==null&&a<e;a++)l=l.next;if(a===e&&l!==null)return l.value},r.prototype.getReverse=function(e){for(var a=0,l=this.tail;l!==null&&a<e;a++)l=l.prev;if(a===e&&l!==null)return l.value},r.prototype.map=function(e,a){a=a||this;for(var l=new r,s=this.head;s!==null;)l.push(e.call(a,s.value,this)),s=s.next;return l},r.prototype.mapReverse=function(e,a){a=a||this;for(var l=new r,s=this.tail;s!==null;)l.push(e.call(a,s.value,this)),s=s.prev;return l},r.prototype.reduce=function(e,a){var l,s=this.head;if(arguments.length>1)l=a;else if(this.head)s=this.head.next,l=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var o=0;s!==null;o++)l=e(l,s.value,o),s=s.next;return l},r.prototype.reduceReverse=function(e,a){var l,s=this.tail;if(arguments.length>1)l=a;else if(this.tail)s=this.tail.prev,l=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var o=this.length-1;s!==null;o--)l=e(l,s.value,o),s=s.prev;return l},r.prototype.toArray=function(){for(var e=new Array(this.length),a=0,l=this.head;l!==null;a++)e[a]=l.value,l=l.next;return e},r.prototype.toArrayReverse=function(){for(var e=new Array(this.length),a=0,l=this.tail;l!==null;a++)e[a]=l.value,l=l.prev;return e},r.prototype.slice=function(e,a){a=a||this.length,a<0&&(a+=this.length),e=e||0,e<0&&(e+=this.length);var l=new r;if(a<e||a<0)return l;e<0&&(e=0),a>this.length&&(a=this.length);for(var s=0,o=this.head;o!==null&&s<e;s++)o=o.next;for(;o!==null&&s<a;s++,o=o.next)l.push(o.value);return l},r.prototype.sliceReverse=function(e,a){a=a||this.length,a<0&&(a+=this.length),e=e||0,e<0&&(e+=this.length);var l=new r;if(a<e||a<0)return l;e<0&&(e=0),a>this.length&&(a=this.length);for(var s=this.length,o=this.tail;o!==null&&s>a;s--)o=o.prev;for(;o!==null&&s>e;s--,o=o.prev)l.push(o.value);return l},r.prototype.splice=function(e,a,...l){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var s=0,o=this.head;o!==null&&s<e;s++)o=o.next;for(var h=[],s=0;o&&s<a;s++)h.push(o.value),o=this.removeNode(o);o===null&&(o=this.tail),o!==this.head&&o!==this.tail&&(o=o.prev);for(var s=0;s<l.length;s++)o=n(this,o,l[s]);return h},r.prototype.reverse=function(){for(var e=this.head,a=this.tail,l=e;l!==null;l=l.prev){var s=l.prev;l.prev=l.next,l.next=s}return this.head=a,this.tail=e,this};function n(e,a,l){var s=a===e.head?new c(l,null,a,e):new c(l,a,a.next,e);return s.next===null&&(e.tail=s),s.prev===null&&(e.head=s),e.length++,s}function t(e,a){e.tail=new c(a,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function i(e,a){e.head=new c(a,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function c(e,a,l,s){if(!(this instanceof c))return new c(e,a,l,s);this.list=s,this.value=e,a?(a.next=this,this.prev=a):this.prev=null,l?(l.prev=this,this.next=l):this.next=null}try{vn()(r)}catch{}return Ie}var Re,st;function En(){if(st)return Re;st=1;const r=dn(),n=Symbol("max"),t=Symbol("length"),i=Symbol("lengthCalculator"),c=Symbol("allowStale"),e=Symbol("maxAge"),a=Symbol("dispose"),l=Symbol("noDisposeOnSet"),s=Symbol("lruList"),o=Symbol("cache"),h=Symbol("updateAgeOnGet"),f=()=>1;class S{constructor(u){if(typeof u=="number"&&(u={max:u}),u||(u={}),u.max&&(typeof u.max!="number"||u.max<0))throw new TypeError("max must be a non-negative number");this[n]=u.max||1/0;const I=u.length||f;if(this[i]=typeof I!="function"?f:I,this[c]=u.stale||!1,u.maxAge&&typeof u.maxAge!="number")throw new TypeError("maxAge must be a number");this[e]=u.maxAge||0,this[a]=u.dispose,this[l]=u.noDisposeOnSet||!1,this[h]=u.updateAgeOnGet||!1,this.reset()}set max(u){if(typeof u!="number"||u<0)throw new TypeError("max must be a non-negative number");this[n]=u||1/0,_(this)}get max(){return this[n]}set allowStale(u){this[c]=!!u}get allowStale(){return this[c]}set maxAge(u){if(typeof u!="number")throw new TypeError("maxAge must be a non-negative number");this[e]=u,_(this)}get maxAge(){return this[e]}set lengthCalculator(u){typeof u!="function"&&(u=f),u!==this[i]&&(this[i]=u,this[t]=0,this[s].forEach(I=>{I.length=this[i](I.value,I.key),this[t]+=I.length})),_(this)}get lengthCalculator(){return this[i]}get length(){return this[t]}get itemCount(){return this[s].length}rforEach(u,I){I=I||this;for(let N=this[s].tail;N!==null;){const O=N.prev;P(this,u,N,I),N=O}}forEach(u,I){I=I||this;for(let N=this[s].head;N!==null;){const O=N.next;P(this,u,N,I),N=O}}keys(){return this[s].toArray().map(u=>u.key)}values(){return this[s].toArray().map(u=>u.value)}reset(){this[a]&&this[s]&&this[s].length&&this[s].forEach(u=>this[a](u.key,u.value)),this[o]=new Map,this[s]=new r,this[t]=0}dump(){return this[s].map(u=>E(this,u)?!1:{k:u.key,v:u.value,e:u.now+(u.maxAge||0)}).toArray().filter(u=>u)}dumpLru(){return this[s]}set(u,I,N){if(N=N||this[e],N&&typeof N!="number")throw new TypeError("maxAge must be a number");const O=N?Date.now():0,F=this[i](I,u);if(this[o].has(u)){if(F>this[n])return b(this,this[o].get(u)),!1;const Z=this[o].get(u).value;return this[a]&&(this[l]||this[a](u,Z.value)),Z.now=O,Z.maxAge=N,Z.value=I,this[t]+=F-Z.length,Z.length=F,this.get(u),_(this),!0}const Q=new U(u,I,F,O,N);return Q.length>this[n]?(this[a]&&this[a](u,I),!1):(this[t]+=Q.length,this[s].unshift(Q),this[o].set(u,this[s].head),_(this),!0)}has(u){if(!this[o].has(u))return!1;const I=this[o].get(u).value;return!E(this,I)}get(u){return v(this,u,!0)}peek(u){return v(this,u,!1)}pop(){const u=this[s].tail;return u?(b(this,u),u.value):null}del(u){b(this,this[o].get(u))}load(u){this.reset();const I=Date.now();for(let N=u.length-1;N>=0;N--){const O=u[N],F=O.e||0;if(F===0)this.set(O.k,O.v);else{const Q=F-I;Q>0&&this.set(O.k,O.v,Q)}}}prune(){this[o].forEach((u,I)=>v(this,I,!1))}}const v=(y,u,I)=>{const N=y[o].get(u);if(N){const O=N.value;if(E(y,O)){if(b(y,N),!y[c])return}else I&&(y[h]&&(N.value.now=Date.now()),y[s].unshiftNode(N));return O.value}},E=(y,u)=>{if(!u||!u.maxAge&&!y[e])return!1;const I=Date.now()-u.now;return u.maxAge?I>u.maxAge:y[e]&&I>y[e]},_=y=>{if(y[t]>y[n])for(let u=y[s].tail;y[t]>y[n]&&u!==null;){const I=u.prev;b(y,u),u=I}},b=(y,u)=>{if(u){const I=u.value;y[a]&&y[a](I.key,I.value),y[t]-=I.length,y[o].delete(I.key),y[s].removeNode(u)}};class U{constructor(u,I,N,O,F){this.key=u,this.value=I,this.length=N,this.now=O,this.maxAge=F||0}}const P=(y,u,I,N)=>{let O=I.value;E(y,O)&&(b(y,I),y[c]||(O=void 0)),O&&u.call(N,O.value,O.key,y)};return Re=S,Re}var Se,it;function V(){if(it)return Se;it=1;class r{constructor(p,R){if(R=i(R),p instanceof r)return p.loose===!!R.loose&&p.includePrerelease===!!R.includePrerelease?p:new r(p.raw,R);if(p instanceof c)return this.raw=p.value,this.set=[[p]],this.format(),this;if(this.options=R,this.loose=!!R.loose,this.includePrerelease=!!R.includePrerelease,this.raw=p.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map($=>this.parseRange($.trim())).filter($=>$.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const $=this.set[0];if(this.set=this.set.filter(g=>!E(g[0])),this.set.length===0)this.set=[$];else if(this.set.length>1){for(const g of this.set)if(g.length===1&&_(g[0])){this.set=[g];break}}}this.format()}format(){return this.range=this.set.map(p=>p.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(p){const $=((this.options.includePrerelease&&S)|(this.options.loose&&v))+":"+p,g=t.get($);if(g)return g;const m=this.options.loose,T=m?l[s.HYPHENRANGELOOSE]:l[s.HYPHENRANGE];p=p.replace(T,Z(this.options.includePrerelease)),e("hyphen replace",p),p=p.replace(l[s.COMPARATORTRIM],o),e("comparator trim",p),p=p.replace(l[s.TILDETRIM],h),e("tilde trim",p),p=p.replace(l[s.CARETTRIM],f),e("caret trim",p);let w=p.split(" ").map(C=>U(C,this.options)).join(" ").split(/\s+/).map(C=>Me(C,this.options));m&&(w=w.filter(C=>(e("loose invalid filter",C,this.options),!!C.match(l[s.COMPARATORLOOSE])))),e("range list",w);const L=new Map,A=w.map(C=>new c(C,this.options));for(const C of A){if(E(C))return[C];L.set(C.value,C)}L.size>1&&L.has("")&&L.delete("");const j=[...L.values()];return t.set($,j),j}intersects(p,R){if(!(p instanceof r))throw new TypeError("a Range is required");return this.set.some($=>b($,R)&&p.set.some(g=>b(g,R)&&$.every(m=>g.every(T=>m.intersects(T,R)))))}test(p){if(!p)return!1;if(typeof p=="string")try{p=new a(p,this.options)}catch{return!1}for(let R=0;R<this.set.length;R++)if(Gt(this.set[R],p,this.options))return!0;return!1}}Se=r;const n=En(),t=new n({max:1e3}),i=Ue,c=me(),e=de,a=G,{safeRe:l,t:s,comparatorTrimReplace:o,tildeTrimReplace:h,caretTrimReplace:f}=ae,{FLAG_INCLUDE_PRERELEASE:S,FLAG_LOOSE:v}=ve,E=d=>d.value==="<0.0.0-0",_=d=>d.value==="",b=(d,p)=>{let R=!0;const $=d.slice();let g=$.pop();for(;R&&$.length;)R=$.every(m=>g.intersects(m,p)),g=$.pop();return R},U=(d,p)=>(e("comp",d,p),d=I(d,p),e("caret",d),d=y(d,p),e("tildes",d),d=O(d,p),e("xrange",d),d=Q(d,p),e("stars",d),d),P=d=>!d||d.toLowerCase()==="x"||d==="*",y=(d,p)=>d.trim().split(/\s+/).map(R=>u(R,p)).join(" "),u=(d,p)=>{const R=p.loose?l[s.TILDELOOSE]:l[s.TILDE];return d.replace(R,($,g,m,T,w)=>{e("tilde",d,$,g,m,T,w);let L;return P(g)?L="":P(m)?L=`>=${g}.0.0 <${+g+1}.0.0-0`:P(T)?L=`>=${g}.${m}.0 <${g}.${+m+1}.0-0`:w?(e("replaceTilde pr",w),L=`>=${g}.${m}.${T}-${w} <${g}.${+m+1}.0-0`):L=`>=${g}.${m}.${T} <${g}.${+m+1}.0-0`,e("tilde return",L),L})},I=(d,p)=>d.trim().split(/\s+/).map(R=>N(R,p)).join(" "),N=(d,p)=>{e("caret",d,p);const R=p.loose?l[s.CARETLOOSE]:l[s.CARET],$=p.includePrerelease?"-0":"";return d.replace(R,(g,m,T,w,L)=>{e("caret",d,g,m,T,w,L);let A;return P(m)?A="":P(T)?A=`>=${m}.0.0${$} <${+m+1}.0.0-0`:P(w)?m==="0"?A=`>=${m}.${T}.0${$} <${m}.${+T+1}.0-0`:A=`>=${m}.${T}.0${$} <${+m+1}.0.0-0`:L?(e("replaceCaret pr",L),m==="0"?T==="0"?A=`>=${m}.${T}.${w}-${L} <${m}.${T}.${+w+1}-0`:A=`>=${m}.${T}.${w}-${L} <${m}.${+T+1}.0-0`:A=`>=${m}.${T}.${w}-${L} <${+m+1}.0.0-0`):(e("no pr"),m==="0"?T==="0"?A=`>=${m}.${T}.${w}${$} <${m}.${T}.${+w+1}-0`:A=`>=${m}.${T}.${w}${$} <${m}.${+T+1}.0-0`:A=`>=${m}.${T}.${w} <${+m+1}.0.0-0`),e("caret return",A),A})},O=(d,p)=>(e("replaceXRanges",d,p),d.split(/\s+/).map(R=>F(R,p)).join(" ")),F=(d,p)=>{d=d.trim();const R=p.loose?l[s.XRANGELOOSE]:l[s.XRANGE];return d.replace(R,($,g,m,T,w,L)=>{e("xRange",d,$,g,m,T,w,L);const A=P(m),j=A||P(T),C=j||P(w),se=C;return g==="="&&se&&(g=""),L=p.includePrerelease?"-0":"",A?g===">"||g==="<"?$="<0.0.0-0":$="*":g&&se?(j&&(T=0),w=0,g===">"?(g=">=",j?(m=+m+1,T=0,w=0):(T=+T+1,w=0)):g==="<="&&(g="<",j?m=+m+1:T=+T+1),g==="<"&&(L="-0"),$=`${g+m}.${T}.${w}${L}`):j?$=`>=${m}.0.0${L} <${+m+1}.0.0-0`:C&&($=`>=${m}.${T}.0${L} <${m}.${+T+1}.0-0`),e("xRange return",$),$})},Q=(d,p)=>(e("replaceStars",d,p),d.trim().replace(l[s.STAR],"")),Me=(d,p)=>(e("replaceGTE0",d,p),d.trim().replace(l[p.includePrerelease?s.GTE0PRE:s.GTE0],"")),Z=d=>(p,R,$,g,m,T,w,L,A,j,C,se,ks)=>(P($)?R="":P(g)?R=`>=${$}.0.0${d?"-0":""}`:P(m)?R=`>=${$}.${g}.0${d?"-0":""}`:T?R=`>=${R}`:R=`>=${R}${d?"-0":""}`,P(A)?L="":P(j)?L=`<${+A+1}.0.0-0`:P(C)?L=`<${A}.${+j+1}.0-0`:se?L=`<=${A}.${j}.${C}-${se}`:d?L=`<${A}.${j}.${+C+1}-0`:L=`<=${L}`,`${R} ${L}`.trim()),Gt=(d,p,R)=>{for(let $=0;$<d.length;$++)if(!d[$].test(p))return!1;if(p.prerelease.length&&!R.includePrerelease){for(let $=0;$<d.length;$++)if(e(d[$].semver),d[$].semver!==c.ANY&&d[$].semver.prerelease.length>0){const g=d[$].semver;if(g.major===p.major&&g.minor===p.minor&&g.patch===p.patch)return!0}return!1}return!0};return Se}var Te,at;function me(){if(at)return Te;at=1;const r=Symbol("SemVer ANY");class n{static get ANY(){return r}constructor(h,f){if(f=t(f),h instanceof n){if(h.loose===!!f.loose)return h;h=h.value}h=h.trim().split(/\s+/).join(" "),a("comparator",h,f),this.options=f,this.loose=!!f.loose,this.parse(h),this.semver===r?this.value="":this.value=this.operator+this.semver.version,a("comp",this)}parse(h){const f=this.options.loose?i[c.COMPARATORLOOSE]:i[c.COMPARATOR],S=h.match(f);if(!S)throw new TypeError(`Invalid comparator: ${h}`);this.operator=S[1]!==void 0?S[1]:"",this.operator==="="&&(this.operator=""),S[2]?this.semver=new l(S[2],this.options.loose):this.semver=r}toString(){return this.value}test(h){if(a("Comparator.test",h,this.options.loose),this.semver===r||h===r)return!0;if(typeof h=="string")try{h=new l(h,this.options)}catch{return!1}return e(h,this.operator,this.semver,this.options)}intersects(h,f){if(!(h instanceof n))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new s(h.value,f).test(this.value):h.operator===""?h.value===""?!0:new s(this.value,f).test(h.semver):(f=t(f),f.includePrerelease&&(this.value==="<0.0.0-0"||h.value==="<0.0.0-0")||!f.includePrerelease&&(this.value.startsWith("<0.0.0")||h.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&h.operator.startsWith(">")||this.operator.startsWith("<")&&h.operator.startsWith("<")||this.semver.version===h.semver.version&&this.operator.includes("=")&&h.operator.includes("=")||e(this.semver,"<",h.semver,f)&&this.operator.startsWith(">")&&h.operator.startsWith("<")||e(this.semver,">",h.semver,f)&&this.operator.startsWith("<")&&h.operator.startsWith(">")))}}Te=n;const t=Ue,{safeRe:i,t:c}=ae,e=Pt,a=de,l=G,s=V();return Te}const mn=V(),$n=(r,n,t)=>{try{n=new mn(n,t)}catch{return!1}return n.test(r)};var $e=$n;const gn=V(),In=(r,n)=>new gn(r,n).set.map(t=>t.map(i=>i.value).join(" ").trim().split(" "));var Rn=In;const Sn=G,Tn=V(),yn=(r,n,t)=>{let i=null,c=null,e=null;try{e=new Tn(n,t)}catch{return null}return r.forEach(a=>{e.test(a)&&(!i||c.compare(a)===-1)&&(i=a,c=new Sn(i,t))}),i};var Ln=yn;const Nn=G,wn=V(),On=(r,n,t)=>{let i=null,c=null,e=null;try{e=new wn(n,t)}catch{return null}return r.forEach(a=>{e.test(a)&&(!i||c.compare(a)===1)&&(i=a,c=new Nn(i,t))}),i};var An=On;const ye=G,bn=V(),ot=Ee,xn=(r,n)=>{r=new bn(r,n);let t=new ye("0.0.0");if(r.test(t)||(t=new ye("0.0.0-0"),r.test(t)))return t;t=null;for(let i=0;i<r.set.length;++i){const c=r.set[i];let e=null;c.forEach(a=>{const l=new ye(a.semver.version);switch(a.operator){case">":l.prerelease.length===0?l.patch++:l.prerelease.push(0),l.raw=l.format();case"":case">=":(!e||ot(l,e))&&(e=l);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${a.operator}`)}}),e&&(!t||ot(t,e))&&(t=e)}return t&&r.test(t)?t:null};var _n=xn;const Pn=V(),Cn=(r,n)=>{try{return new Pn(r,n).range||"*"}catch{return null}};var Dn=Cn;const Un=G,Ct=me(),{ANY:Gn}=Ct,jn=V(),Fn=$e,lt=Ee,ct=je,Xn=Xe,Vn=Fe,Bn=(r,n,t,i)=>{r=new Un(r,i),n=new jn(n,i);let c,e,a,l,s;switch(t){case">":c=lt,e=Xn,a=ct,l=">",s=">=";break;case"<":c=ct,e=Vn,a=lt,l="<",s="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(Fn(r,n,i))return!1;for(let o=0;o<n.set.length;++o){const h=n.set[o];let f=null,S=null;if(h.forEach(v=>{v.semver===Gn&&(v=new Ct(">=0.0.0")),f=f||v,S=S||v,c(v.semver,f.semver,i)?f=v:a(v.semver,S.semver,i)&&(S=v)}),f.operator===l||f.operator===s||(!S.operator||S.operator===l)&&e(r,S.semver))return!1;if(S.operator===s&&a(r,S.semver))return!1}return!0};var Ve=Bn;const qn=Ve,Mn=(r,n,t)=>qn(r,n,">",t);var Hn=Mn;const zn=Ve,Yn=(r,n,t)=>zn(r,n,"<",t);var Wn=Yn;const ut=V(),Kn=(r,n,t)=>(r=new ut(r,t),n=new ut(n,t),r.intersects(n,t));var Qn=Kn;const Zn=$e,Jn=X;var kn=(r,n,t)=>{const i=[];let c=null,e=null;const a=r.sort((h,f)=>Jn(h,f,t));for(const h of a)Zn(h,n,t)?(e=h,c||(c=h)):(e&&i.push([c,e]),e=null,c=null);c&&i.push([c,null]);const l=[];for(const[h,f]of i)h===f?l.push(h):!f&&h===a[0]?l.push("*"):f?h===a[0]?l.push(`<=${f}`):l.push(`${h} - ${f}`):l.push(`>=${h}`);const s=l.join(" || "),o=typeof n.raw=="string"?n.raw:String(n);return s.length<o.length?s:n};const ht=V(),Be=me(),{ANY:Le}=Be,ie=$e,qe=X,es=(r,n,t={})=>{if(r===n)return!0;r=new ht(r,t),n=new ht(n,t);let i=!1;e:for(const c of r.set){for(const e of n.set){const a=rs(c,e,t);if(i=i||a!==null,a)continue e}if(i)return!1}return!0},ts=[new Be(">=0.0.0-0")],ft=[new Be(">=0.0.0")],rs=(r,n,t)=>{if(r===n)return!0;if(r.length===1&&r[0].semver===Le){if(n.length===1&&n[0].semver===Le)return!0;t.includePrerelease?r=ts:r=ft}if(n.length===1&&n[0].semver===Le){if(t.includePrerelease)return!0;n=ft}const i=new Set;let c,e;for(const v of r)v.operator===">"||v.operator===">="?c=pt(c,v,t):v.operator==="<"||v.operator==="<="?e=vt(e,v,t):i.add(v.semver);if(i.size>1)return null;let a;if(c&&e){if(a=qe(c.semver,e.semver,t),a>0)return null;if(a===0&&(c.operator!==">="||e.operator!=="<="))return null}for(const v of i){if(c&&!ie(v,String(c),t)||e&&!ie(v,String(e),t))return null;for(const E of n)if(!ie(v,String(E),t))return!1;return!0}let l,s,o,h,f=e&&!t.includePrerelease&&e.semver.prerelease.length?e.semver:!1,S=c&&!t.includePrerelease&&c.semver.prerelease.length?c.semver:!1;f&&f.prerelease.length===1&&e.operator==="<"&&f.prerelease[0]===0&&(f=!1);for(const v of n){if(h=h||v.operator===">"||v.operator===">=",o=o||v.operator==="<"||v.operator==="<=",c){if(S&&v.semver.prerelease&&v.semver.prerelease.length&&v.semver.major===S.major&&v.semver.minor===S.minor&&v.semver.patch===S.patch&&(S=!1),v.operator===">"||v.operator===">="){if(l=pt(c,v,t),l===v&&l!==c)return!1}else if(c.operator===">="&&!ie(c.semver,String(v),t))return!1}if(e){if(f&&v.semver.prerelease&&v.semver.prerelease.length&&v.semver.major===f.major&&v.semver.minor===f.minor&&v.semver.patch===f.patch&&(f=!1),v.operator==="<"||v.operator==="<="){if(s=vt(e,v,t),s===v&&s!==e)return!1}else if(e.operator==="<="&&!ie(e.semver,String(v),t))return!1}if(!v.operator&&(e||c)&&a!==0)return!1}return!(c&&o&&!e&&a!==0||e&&h&&!c&&a!==0||S||f)},pt=(r,n,t)=>{if(!r)return n;const i=qe(r.semver,n.semver,t);return i>0?r:i<0||n.operator===">"&&r.operator===">="?n:r},vt=(r,n,t)=>{if(!r)return n;const i=qe(r.semver,n.semver,t);return i<0?r:i>0||n.operator==="<"&&r.operator==="<="?n:r};var ns=es;const Ne=ae,dt=ve,ss=G,Et=bt,is=ne,as=ur,os=pr,ls=dr,cs=mr,us=Ir,hs=Tr,fs=Nr,ps=Ar,vs=X,ds=Pr,Es=Ur,ms=Ge,$s=Xr,gs=qr,Is=Ee,Rs=je,Ss=xt,Ts=_t,ys=Fe,Ls=Xe,Ns=Pt,ws=pn,Os=me(),As=V(),bs=$e,xs=Rn,_s=Ln,Ps=An,Cs=_n,Ds=Dn,Us=Ve,Gs=Hn,js=Wn,Fs=Qn,Xs=kn,Vs=ns;var Bs={parse:is,valid:as,clean:os,inc:ls,diff:cs,major:us,minor:hs,patch:fs,prerelease:ps,compare:vs,rcompare:ds,compareLoose:Es,compareBuild:ms,sort:$s,rsort:gs,gt:Is,lt:Rs,eq:Ss,neq:Ts,gte:ys,lte:Ls,cmp:Ns,coerce:ws,Comparator:Os,Range:As,satisfies:bs,toComparators:xs,maxSatisfying:_s,minSatisfying:Ps,minVersion:Cs,validRange:Ds,outside:Us,gtr:Gs,ltr:js,intersects:Fs,simplifyRange:Xs,subset:Vs,SemVer:ss,re:Ne.re,src:Ne.src,tokens:Ne.t,SEMVER_SPEC_VERSION:dt.SEMVER_SPEC_VERSION,RELEASE_TYPES:dt.RELEASE_TYPES,compareIdentifiers:Et.compareIdentifiers,rcompareIdentifiers:Et.rcompareIdentifiers};const mt=De(Bs);var _e=globalThis&&globalThis.__assign||function(){return _e=Object.assign||function(r){for(var n,t=1,i=arguments.length;t<i;t++){n=arguments[t];for(var c in n)Object.prototype.hasOwnProperty.call(n,c)&&(r[c]=n[c])}return r},_e.apply(this,arguments)},k,D;(function(r){r.blue="blue",r.nanoS="nanoS",r.nanoSP="nanoSP",r.nanoX="nanoX",r.nanoFTS="nanoFTS"})(D||(D={}));var Pe=(k={},k[D.blue]={id:D.blue,productName:"Ledger Blue",productIdMM:0,legacyUsbProductId:0,usbOnly:!0,memorySize:480*1024,masks:[822083584,822149120],getBlockSize:function(r){return 4*1024}},k[D.nanoS]={id:D.nanoS,productName:"Ledger Nano S",productIdMM:16,legacyUsbProductId:1,usbOnly:!0,memorySize:320*1024,masks:[823132160],getBlockSize:function(r){var n;return mt.lt((n=mt.coerce(r))!==null&&n!==void 0?n:"","2.0.0")?4*1024:2*1024}},k[D.nanoSP]={id:D.nanoSP,productName:"Ledger Nano S Plus",productIdMM:80,legacyUsbProductId:5,usbOnly:!0,memorySize:1536*1024,masks:[856686592],getBlockSize:function(r){return 32}},k[D.nanoX]={id:D.nanoX,productName:"Ledger Nano X",productIdMM:64,legacyUsbProductId:4,usbOnly:!1,memorySize:2*1024*1024,masks:[855638016],getBlockSize:function(r){return 4*1024},bluetoothSpec:[{serviceUuid:"13d63400-2c97-0004-0000-4c6564676572",notifyUuid:"13d63400-2c97-0004-0001-4c6564676572",writeUuid:"13d63400-2c97-0004-0002-4c6564676572",writeCmdUuid:"13d63400-2c97-0004-0003-4c6564676572"}]},k[D.nanoFTS]={id:D.nanoFTS,productName:"Ledger Nano FTS",productIdMM:96,legacyUsbProductId:6,usbOnly:!1,memorySize:2*1024*1024,masks:[857735168],getBlockSize:function(r){return 4*1024},bluetoothSpec:[{serviceUuid:"13d63400-2c97-6004-0000-4c6564676572",notifyUuid:"13d63400-2c97-6004-0001-4c6564676572",writeUuid:"13d63400-2c97-6004-0002-4c6564676572",writeCmdUuid:"13d63400-2c97-6004-0003-4c6564676572"}]},k);D.blue,D.nanoS,D.nanoSP,D.nanoX,D.nanoFTS;var $t=Object.values(Pe),Dt=11415,gt=function(r){var n=$t.find(function(c){return c.legacyUsbProductId===r});if(n)return n;var t=r>>8,i=$t.find(function(c){return c.productIdMM===t});return i},qs=[],It={};for(var Ms in Pe){var Rt=Pe[Ms],we=Rt.bluetoothSpec;if(we)for(var Oe=0;Oe<we.length;Oe++){var he=we[Oe];qs.push(he.serviceUuid),It[he.serviceUuid]=It[he.serviceUuid.replace(/-/g,"")]=_e({deviceModel:Rt},he)}}var Hs=0,J=[],St=function(r,n,t){var i={type:r,id:String(++Hs),date:new Date};n&&(i.message=n),t&&(i.data=t),Ys(i)},zs=function(r){return J.push(r),function(){var n=J.indexOf(r);n!==-1&&(J[n]=J[J.length-1],J.pop())}};function Ys(r){for(var n=0;n<J.length;n++)try{J[n](r)}catch(t){console.error(t)}}typeof window<"u"&&(window.__ledgerLogsListen=zs);var Ws=globalThis&&globalThis.__extends||function(){var r=function(n,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,c){i.__proto__=c}||function(i,c){for(var e in c)Object.prototype.hasOwnProperty.call(c,e)&&(i[e]=c[e])},r(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(n,t);function i(){this.constructor=n}n.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),z=globalThis&&globalThis.__awaiter||function(r,n,t,i){function c(e){return e instanceof t?e:new t(function(a){a(e)})}return new(t||(t=Promise))(function(e,a){function l(h){try{o(i.next(h))}catch(f){a(f)}}function s(h){try{o(i.throw(h))}catch(f){a(f)}}function o(h){h.done?e(h.value):c(h.value).then(l,s)}o((i=i.apply(r,n||[])).next())})},Y=globalThis&&globalThis.__generator||function(r,n){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,c,e,a;return a={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function l(o){return function(h){return s([o,h])}}function s(o){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,c&&(e=o[0]&2?c.return:o[0]?c.throw||((e=c.return)&&e.call(c),0):c.next)&&!(e=e.call(c,o[1])).done)return e;switch(c=0,e&&(o=[o[0]&2,e.value]),o[0]){case 0:case 1:e=o;break;case 4:return t.label++,{value:o[1],done:!1};case 5:t.label++,c=o[1],o=[0];continue;case 7:o=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(o[0]===6||o[0]===2)){t=0;continue}if(o[0]===3&&(!e||o[1]>e[0]&&o[1]<e[3])){t.label=o[1];break}if(o[0]===6&&t.label<e[1]){t.label=e[1],e=o;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(o);break}e[2]&&t.ops.pop(),t.trys.pop();continue}o=n.call(r,t)}catch(h){o=[6,h],c=0}finally{i=e=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},Ks=globalThis&&globalThis.__read||function(r,n){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var i=t.call(r),c,e=[],a;try{for(;(n===void 0||n-- >0)&&!(c=i.next()).done;)e.push(c.value)}catch(l){a={error:l}}finally{try{c&&!c.done&&(t=i.return)&&t.call(i)}finally{if(a)throw a.error}}return e},Qs=[{vendorId:Dt}],Zs=function(){return Promise.resolve(!!(window.navigator&&window.navigator.hid))},pe=function(){var r=navigator.hid;if(!r)throw new Bt("navigator.hid is not supported","HIDNotSupported");return r};function Ut(){return z(this,void 0,void 0,function(){var r;return Y(this,function(n){switch(n.label){case 0:return[4,pe().requestDevice({filters:Qs})];case 1:return r=n.sent(),Array.isArray(r)?[2,r]:[2,[r]]}})})}function Ce(){return z(this,void 0,void 0,function(){var r;return Y(this,function(n){switch(n.label){case 0:return[4,pe().getDevices()];case 1:return r=n.sent(),[2,r.filter(function(t){return t.vendorId===Dt})]}})})}function Js(){return z(this,void 0,void 0,function(){var r,n;return Y(this,function(t){switch(t.label){case 0:return[4,Ce()];case 1:return r=t.sent(),r.length>0?[2,r[0]]:[4,Ut()];case 2:return n=t.sent(),[2,n[0]]}})})}var ri=function(r){Ws(n,r);function n(t){var i=r.call(this)||this;return i.channel=Math.floor(Math.random()*65535),i.packetSize=64,i.inputs=[],i.read=function(){return i.inputs.length?Promise.resolve(i.inputs.shift()):new Promise(function(c){i.inputCallback=c})},i.onInputReport=function(c){var e=H.Buffer.from(c.data.buffer);i.inputCallback?(i.inputCallback(e),i.inputCallback=null):i.inputs.push(e)},i._disconnectEmitted=!1,i._emitDisconnect=function(c){i._disconnectEmitted||(i._disconnectEmitted=!0,i.emit("disconnect",c))},i.exchange=function(c){return z(i,void 0,void 0,function(){var e,a=this;return Y(this,function(l){switch(l.label){case 0:return[4,this.exchangeAtomicImpl(function(){return z(a,void 0,void 0,function(){var s,o,h,f,S,v,E,_,b;return Y(this,function(U){switch(U.label){case 0:s=this,o=s.channel,h=s.packetSize,St("apdu","=> "+c.toString("hex")),f=Wt(o,h),S=f.makeBlocks(c),v=0,U.label=1;case 1:return v<S.length?[4,this.device.sendReport(0,S[v])]:[3,4];case 2:U.sent(),U.label=3;case 3:return v++,[3,1];case 4:return(E=f.getReducedResult(_))?[3,6]:[4,this.read()];case 5:return b=U.sent(),_=f.reduceResponse(_,b),[3,4];case 6:return St("apdu","<= "+E.toString("hex")),[2,E]}})})}).catch(function(s){throw s&&s.message&&s.message.includes("write")?(a._emitDisconnect(s),new Xt(s.message)):s})];case 1:return e=l.sent(),[2,e]}})})},i.device=t,i.deviceModel=typeof t.productId=="number"?gt(t.productId):void 0,t.addEventListener("inputreport",i.onInputReport),i}return n.request=function(){return z(this,void 0,void 0,function(){var t,i;return Y(this,function(c){switch(c.label){case 0:return[4,Ut()];case 1:return t=Ks.apply(void 0,[c.sent(),1]),i=t[0],[2,n.open(i)]}})})},n.openConnected=function(){return z(this,void 0,void 0,function(){var t;return Y(this,function(i){switch(i.label){case 0:return[4,Ce()];case 1:return t=i.sent(),t.length===0?[2,null]:[2,n.open(t[0])]}})})},n.open=function(t){return z(this,void 0,void 0,function(){var i,c;return Y(this,function(e){switch(e.label){case 0:return[4,t.open()];case 1:return e.sent(),i=new n(t),c=function(a){t===a.device&&(pe().removeEventListener("disconnect",c),i._emitDisconnect(new qt))},pe().addEventListener("disconnect",c),[2,i]}})})},n.prototype.close=function(){return z(this,void 0,void 0,function(){return Y(this,function(t){switch(t.label){case 0:return[4,this.exchangeBusyPromise];case 1:return t.sent(),this.device.removeEventListener("inputreport",this.onInputReport),[4,this.device.close()];case 2:return t.sent(),[2]}})})},n.prototype.setScrambleKey=function(){},n.isSupported=Zs,n.list=Ce,n.listen=function(t){var i=!1;Js().then(function(e){if(!e)t.error(new He("Access denied to use Ledger device"));else if(!i){var a=typeof e.productId=="number"?gt(e.productId):void 0;t.next({type:"add",descriptor:e,deviceModel:a}),t.complete()}},function(e){t.error(new He(e.message))});function c(){i=!0}return{unsubscribe:c}},n}(Vt);export{ri as default};
